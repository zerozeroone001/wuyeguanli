<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.SysInspectionPlanMapper">
    
    <resultMap type="com.ruoyi.system.domain.SysInspectionPlan" id="SysInspectionPlanResult">
        <result property="planId" column="plan_id"/>
        <result property="planName" column="plan_name"/>
        <result property="inspectionType" column="inspection_type"/>
        <result property="startDate" column="start_date"/>
        <result property="endDate" column="end_date"/>
        <result property="inspector" column="inspector"/>
        <result property="supervisionTarget" column="supervision_target"/>
        <result property="description" column="description"/>
        <result property="status" column="status"/>
        <result property="createBy" column="create_by"/>
        <result property="createTime" column="create_time"/>
        <result property="updateBy" column="update_by"/>
        <result property="updateTime" column="update_time"/>
        <result property="remark" column="remark"/>
    </resultMap>

    <sql id="selectSysInspectionPlanVo">
        select plan_id, plan_name, inspection_type, start_date, end_date, inspector, supervision_target, description, status, create_by, create_time, update_by, update_time, remark from sys_inspection_plan
    </sql>

    <select id="selectSysInspectionPlanList" parameterType="com.ruoyi.system.domain.SysInspectionPlan" resultMap="SysInspectionPlanResult">
        <include refid="selectSysInspectionPlanVo"/>
        <where>
            <if test="planName != null and planName != ''"> and plan_name like concat('%', #{planName}, '%')</if>
            <if test="inspectionType != null and inspectionType != ''"> and inspection_type = #{inspectionType}</if>
            <if test="supervisionTarget != null and supervisionTarget != ''"> and supervision_target like concat('%', #{supervisionTarget}, '%')</if>
            <if test="status != null and status != ''"> and status = #{status}</if>
        </where>
    </select>
    
    <select id="selectSysInspectionPlanByPlanId" parameterType="Long" resultMap="SysInspectionPlanResult">
        <include refid="selectSysInspectionPlanVo"/>
        where plan_id = #{planId}
    </select>
        
    <insert id="insertSysInspectionPlan" parameterType="com.ruoyi.system.domain.SysInspectionPlan" useGeneratedKeys="true" keyProperty="planId">
        insert into sys_inspection_plan (plan_name, inspection_type, start_date, end_date, inspector, supervision_target, description, status, create_by, create_time, update_by, update_time, remark)
        values (#{planName}, #{inspectionType}, #{startDate}, #{endDate}, #{inspector}, #{supervisionTarget}, #{description}, #{status}, #{createBy}, sysdate(), #{updateBy}, sysdate(), #{remark})
    </insert>

    <update id="updateSysInspectionPlan" parameterType="com.ruoyi.system.domain.SysInspectionPlan">
        update sys_inspection_plan
        <set>
            <if test="planName != null and planName != ''">plan_name = #{planName},</if>
            <if test="inspectionType != null and inspectionType != ''">inspection_type = #{inspectionType},</if>
            <if test="startDate != null">start_date = #{startDate},</if>
            <if test="endDate != null">end_date = #{endDate},</if>
            <if test="inspector != null and inspector != ''">inspector = #{inspector},</if>
            <if test="supervisionTarget != null and supervisionTarget != ''">supervision_target = #{supervisionTarget},</if>
            <if test="description != null">description = #{description},</if>
            <if test="status != null and status != ''">status = #{status},</if>
            <if test="updateBy != null and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate(),
            <if test="remark != null">remark = #{remark},</if>
        </set>
        where plan_id = #{planId}
    </update>

    <delete id="deleteSysInspectionPlanByPlanIds" parameterType="String">
        delete from sys_inspection_plan where plan_id in 
        <foreach item="planId" collection="array" open="(" separator="," close=")">
            #{planId}
        </foreach>
    </delete>
</mapper>

---
alwaysApply: true
---
# 若依物业管理系统项目规则

## 项目架构概览

### 项目类型
- 框架：基于若依 (RuoYi) 的 Spring Boot 多模块项目
- 版本：RuoYi 3.9.0，Spring Boot 2.5.15
- JDK：Java 1.8
- 构建工具：Maven
- 数据库：MySQL 5.7+
- 缓存：Redis 6.0+

### 模块结构
```
RuoYi-Vue-master/
|- ruoyi-admin/           # 管理后台模块 (端口 8080)
|- ruoyi-user/            # 用户端 API 模块 (端口 8081)
|- ruoyi-system/          # 系统核心模块
|- ruoyi-framework/       # 框架核心模块
|- ruoyi-common/          # 通用工具模块
|- ruoyi-generator/       # 代码生成模块
|- ruoyi-quartz/          # 定时任务模块
|- ruoyi-ui/              # Vue 前端管理界面
`- ruoyi-app/             # 微信小程序
```

## 技术栈

### 后端
- 核心框架：Spring Boot 2.5.15
- 安全框架：Spring Security 5.7.12
- 任务调度：Quartz
- 持久层框架：MyBatis
- 数据库连接池：Druid 1.2.23
- 缓存：Redis
- JSON 处理：FastJSON 2.0.57
- 文档工具：Swagger3
- Excel 工具：Apache POI 4.1.2
- 模板引擎：Velocity 2.3
- JWT：jjwt 0.9.1

### 前端
- 主框架：Vue 2.6.12
- UI 组件库：Element UI 2.15.14
- 状态管理：Vuex 3.6.0
- 路由：Vue Router 3.4.9
- HTTP 客户端：Axios 0.28.1
- 图表：ECharts 5.4.0
- 富文本：Quill 2.0.2

### 小程序
- 框架：uni-app
- UI 组件库：uni-ui
- 状态管理：Vuex
- 样式框架：ColorUI

### 第三方服务
- 阿里云 OSS：文件存储
- 阿里云 SMS：短信服务
- 阿里云 OCR：文字识别
- 微信小程序 API：用户授权与支付

## 数据库设计

### 核心业务表
1. 用户与权限
   - `sys_user`：系统用户
   - `sys_role`：角色
   - `sys_menu`：菜单权限
   - `sys_dept`：部门
2. 物业管理
   - `estate_community`：小区信息
   - `estate_property`：房产信息
   - `estate_user_property`：用户房产关联
   - `sys_owner_profile`：业主扩展信息
3. 业务功能
   - `sys_property_complaint`：投诉建议
   - `sys_property_meeting`：业主会议
   - `sys_committee_meeting`：业委会会议
   - `sys_general_meeting`：业主大会
   - `sys_property_fund_flow`：资金流水
   - `sys_property_contract`：物业合同
   - `sys_legal_consultation`：法律咨询
   - `sys_notary_application`：公证申请
   - `sys_notary_attachment`：公证附件
   - `sys_visitor`：访客登记
   - `sys_warranty`：设备保修
4. 监督与检查
   - `sys_supervision`：监督检查
   - `sys_inspection_plan`：检查计划
   - `sys_inspection_record`：检查记录
5. 文件管理
   - `sys_file_info`：文件信息
   - `sys_property_regulation`：规章制度

### 字段和命名规范
- 主键：统一使用 `bigint(20) AUTO_INCREMENT`
- 状态字段：使用 `char(1)` 表达 0-正常、1-停用、2-删除
- 时间字段：使用 `datetime`
- 审核状态：0-待审核，1-已通过，2-已驳回
- 删除标志：0-存在，2-删除（逻辑删除）
- 表名：小写加下划线，例如 `sys_user`
- 字段名：小写加下划线，例如 `user_name`
- 索引名：`idx_表名_字段名`

## 前端开发规范

### Vue 组件结构
```vue
<template>
  <!-- 模板内容 -->
</template>

<script>
export default {
  name: 'ComponentName',
  components: {},
  data() {
    return {};
  },
  computed: {},
  methods: {},
  created() {},
  mounted() {}
};
</script>

<style lang="scss" scoped>
/* 样式内容 */
</style>
```

### API 规范
- 基础路径：`/dev-api`（开发环境）
- 请求风格：RESTful
- 统一响应：使用 `AjaxResult`
- 分页参数：`pageNum`、`pageSize`
- 排序参数：`orderByColumn`、`isAsc`

### 路由及权限
- 管理端路由前缀：`/system/`
- 权限控制：使用 `@PreAuthorize`
- 菜单配置：在 `sys_menu` 表中维护

## 小程序开发规范

### 页面目录
```
pages/
├── index.vue
├── login.vue
├── mine/
├── property/
├── legal-consultation/
├── contract-fulfillment/
├── handover/
├── supervision/
└── work/
```

### 命名约定
- 页面组件：PascalCase（例如 `PropertyManagement`）
- 通用组件：kebab-case（例如 `uni-section`）

## 开发配置

### 环境配置
- 开发环境：`application.yml`
- 数据库配置：`application-druid.yml`
- 多环境切换：使用 Spring profiles

### 端口
- 管理后台：8080
- 用户端 API：8081
- 前端开发服务：8082

### 文件上传
- 本地路径：`F:\code\wuyeguanli\uploadPath`
- 阿里云 OSS：bucket `zhuote`

## 编码规范

### Java
1. 包名：`com.ruoyi.模块.功能`
2. 类名：PascalCase，例如 `SysUserController`
3. 方法名：camelCase，例如 `getUserList`
4. 常量名：UPPER_SNAKE_CASE，例如 `DEFAULT_STATUS`

### 前端
1. 组件名：PascalCase，例如 `UserManagement`
2. 方法名：camelCase，例如 `handleSubmit`
3. CSS 类名：kebab-case，例如 `.user-info`

## 部署规范

### 打包命令
```bash
mvn clean package -DskipTests
npm run build:prod
# 小程序打包使用 HBuilderX 或 uni-app CLI
```

### 环境变量
- 数据库连接：统一由配置文件管理
- Redis 连接：支持集群配置
- 文件上传：支持本地和 OSS 双模式

## 安全规范

### 认证授权
- JWT 有效期：20 分钟
- 权限控制：基于 RBAC 模型
- 接口鉴权：使用 `@PreAuthorize`

### 数据安全
- SQL 注入防护：使用 MyBatis 参数绑定
- XSS 防护：启用全局 XSS 过滤
- 文件上传：限制文件类型和大小

## 业务流程

### 核心流程
- 业主认证：注册 -> 实名认证 -> 房产绑定 -> 审核通过
- 投诉处理：提交投诉 -> 分配 -> 处理 -> 反馈 -> 结案
- 会议投票：创建会议 -> 发布议题 -> 业主投票 -> 统计结果
- 资金管理：收费 -> 记录 -> 审核 -> 财务报表

### 状态约定
- 通用状态：0-正常，1-停用，2-删除
- 审核状态：0-待审核，1-已通过，2-已驳回
- 处理状态：0-待处理，1-处理中，2-已完成

## 测试规范

### 单元测试
- 覆盖率要求：70% 以上
- 命名规范：`方法名_场景_期望结果`

### 接口测试
- Swagger 文档：访问 `/swagger-ui.html`
- 测试数据：使用独立的测试数据库

## 文档规范

### 代码注释
- 类注释：说明类的功能和作用
- 方法注释：使用 JavaDoc 格式
- 复杂逻辑：必要时添加行内注释

---
